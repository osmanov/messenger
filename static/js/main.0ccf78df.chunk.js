(this.webpackJsonpmessenger=this.webpackJsonpmessenger||[]).push([[0],{116:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(51),o=n.n(i),a=n(138),c=n(90),s=n(132),u=n(24),l=n(133),d=n(19),b=n(5),j=n(130),f=n(88);function h(){return new Promise((function(e){setTimeout((function(){e([{id:"1",name:"Tomas Haake",instrument:"drums"},{id:"2",name:"Tom Morello",instrument:"guitar"},{id:"3",name:"Chino Moreno",instrument:"singer"},{id:"4",name:"Mike Patton",instrument:"singer"},{id:"5",name:"Bj\xf6rk",instrument:"singer"},{id:"6",name:"Aurora Aksnes",instrument:"singer"}])}),1e3)}))}function g(){return Object(u.useQuery)("users",h)}var m=n(4),O=r.createContext({isMobileSidebarStretched:!1,toggleMobileSidebarToStretched:function(){},isMobileContentManualClose:!1,toggleMobileContentManualClose:function(){}});function x(){var e=r.useContext(O);if(!e)throw new Error("useLayout must be used within a LayoutProvider");return e}function v(e){var t=Object(j.a)(),n=Object(b.a)(t,2),i=n[0],o=n[1],a=Object(j.a)(),c=Object(b.a)(a,2),s=c[0],u=c[1],l=Object(f.a)("(max-width: 30em)"),h=Object(b.a)(l,1)[0],g=w().id;r.useEffect((function(){h?o.on():(o.off(),u.off())}),[h,o,u]),r.useEffect((function(){g?u.off():u.on()}),[g,u]);var x={isMobileSidebarStretched:i,toggleMobileSidebarToStretched:o.toggle,isMobileContentManualClose:s,toggleMobileContentManualClose:u.toggle};return Object(m.jsx)(O.Provider,Object(d.a)({value:x},e))}var p=r.createContext({id:null,setId:function(e){},meta:null});function w(){var e=r.useContext(p);if(!e)throw new Error("useActiveUser must be used within an ActiveProvider");return e}function y(e){var t=r.useState(null),n=Object(b.a)(t,2),i=n[0],o=n[1],a=r.useState(null),c=Object(b.a)(a,2),s=c[0],u=c[1],l=g().data;r.useEffect((function(){if(i){var e=(null===l||void 0===l?void 0:l.find((function(e){return e.id===i})))||null;u(e)}else u(null)}),[i,u,l]);var j={id:i,setId:o,meta:s};return Object(m.jsx)(p.Provider,Object(d.a)({value:j},e))}var C=n(131),S=n(141);function M(){return Object(m.jsx)(C.a,{h:"100%",children:Object(m.jsx)(S.a,{})})}var k=n(140),I=n(134);function E(e){var t=e.name,n=e.instrument,r=e.id,i=e.isOnline,o=w(),a=o.setId,c=o.id===r;return Object(m.jsxs)(s.a,{p:3,onClick:function(){a(r)},bg:c?"blue.400":"white",color:c?"white":"black",cursor:"pointer",_hover:{background:c?"":"gray.100"},children:[Object(m.jsx)(k.a,{children:Object(m.jsx)(k.b,{boxSize:"1.25em",bg:i?"green.500":"tomato"})}),Object(m.jsxs)(l.a,{ml:"3",children:[Object(m.jsx)(I.a,{fontWeight:"bold",children:t}),Object(m.jsx)(I.a,{fontSize:"sm",children:n})]})]})}function P(){var e=g(),t=e.isLoading,n=e.data;return t?Object(m.jsx)(M,{}):Object(m.jsx)(m.Fragment,{children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(r.createElement)(E,Object(d.a)(Object(d.a)({},e),{},{isOnline:!!(t%2),key:e.id}))}))})}function T(){var e=x(),t=e.isMobileSidebarStretched,n=e.isMobileContentManualClose;return t&&!n?null:Object(m.jsx)(l.a,{w:["100%","30%","20%"],bg:"white",borderRight:"1px",borderColor:"gray.300",children:Object(m.jsx)(P,{})})}var B=n(135),L=n(142);function F(){var e=w(),t=e.setId,n=e.meta;return Object(m.jsxs)(s.a,{bg:"white",h:"8%",borderBottom:"1px",borderColor:"gray.300",p:2,alignItems:"center",children:[Object(m.jsx)(B.a,{above:"sm",children:Object(m.jsx)(L.a,{cursor:"pointer",onClick:function(){t(null)},mr:2})}),Object(m.jsx)(I.a,{fontWeight:"bold",children:null===n||void 0===n?void 0:n.name})]})}var A=n(139),Q=n(15),D=n(46),U=n.n(D),W=n(70);function J(){return new Promise((function(e){setTimeout((function(){e(JSON.parse(localStorage.getItem("allUsersMessages")))}),1)}))}function z(){return(z=Object(W.a)(U.a.mark((function e(t){var n,r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return n=e.t0,r=n[t]||[],e.abrupt("return",Promise.resolve(r));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(W.a)(U.a.mark((function e(t){var n,r,i,o,a;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.text,r=t.userId,e.next=3,J();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:return i=e.t0,o=i[r],a={text:n,date:new Date},i[r]=o?[].concat(Object(Q.a)(o),[a]):[a],localStorage.setItem("allUsersMessages",JSON.stringify(i)),e.abrupt("return",Object(d.a)(Object(d.a)({},a),{},{userId:r}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return Object(u.useQuery)(["messagesByUserId",e],(function(){return function(e){return z.apply(this,arguments)}(e)}))}function R(e){var t=Object(u.useMutation)((function(e){return function(e){return H.apply(this,arguments)}(e)}),e);return t}function K(){var e=Object(u.useQueryClient)(),t=r.useState(""),n=Object(b.a)(t,2),i=n[0],o=n[1],a=w().id,c=R({onSuccess:function(){e.invalidateQueries(["messagesByUserId",a]),o("")}});return Object(m.jsx)(l.a,{h:"15%",display:"flex",alignItems:"center",paddingX:5,bg:"white",borderTop:"1px",borderColor:"gray.300",children:Object(m.jsx)("form",{style:{width:"100%"},onKeyDown:function(e){return function(e){if(13===e.keyCode&&!e.shiftKey){e.preventDefault();var t=e.target.value.trim();""!==t&&c.mutate({text:t,userId:a})}}(e)},children:Object(m.jsx)(A.a,{name:"message",placeholder:"Write a message...",value:i,onChange:function(e){o(e.target.value)}})})})}function q(e){var t,n=e.date,r=e.text;return Object(m.jsx)(l.a,{textAlign:"right",children:Object(m.jsxs)(l.a,{borderRadius:"6",borderEndEndRadius:"0",p:2,bg:"white",mb:3,display:"inline-block",textAlign:"left",children:[Object(m.jsx)(I.a,{fontSize:"xs",color:"gray.300",children:new Date(n).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"})}),(t=r,t.split("\n")).map((function(e,t){return Object(m.jsx)(l.a,{children:e},t)}))]},n.toString())})}function G(){var e=w(),t=e.id,n=e.meta,i=N(t),o=i.data,a=i.isLoading,c=V().toBottom,u=!!(null===o||void 0===o?void 0:o.length);r.useLayoutEffect((function(){u&&c()}),[u,c]);var b=t?"77%":"100%";return!u&&n?Object(m.jsx)(l.a,{h:b,children:a?Object(m.jsx)(M,{}):Object(m.jsxs)(_,{children:["Say Hi to ",n.name,"\ud83d\udc4b"]})}):Object(m.jsx)(s.a,{className:"scrollable-area",h:b,alignItems:"end",justifyContent:"end",overflow:"scroll",flexFlow:"row wrap",p:5,children:Object(m.jsx)(l.a,{children:null===o||void 0===o?void 0:o.map((function(e,t){return Object(r.createElement)(q,Object(d.a)(Object(d.a)({},e),{},{key:t}))}))})})}var X=n(137);function $(){var e=w().id,t=V().toBottom,n=x().isMobileSidebarStretched;return r.useEffect((function(){e&&t()}),[e,t]),Object(m.jsx)(m.Fragment,{children:e?Object(m.jsx)(G,{}):n?null:Object(m.jsx)(_,{children:"Select a chat to start messaging"})})}function _(e){var t=e.children;return Object(m.jsx)(C.a,{h:"100%",color:"white",children:Object(m.jsx)(X.a,{children:t})})}function V(){return{toBottom:function(){var e=document.querySelector(".scrollable-area");e&&(e.scrollTop=e.scrollHeight)}}}var Y=function(){var e=x().isMobileContentManualClose,t=w().id;return Object(m.jsxs)(l.a,{flex:"1",w:[e?0:"100%","70%","80%"],bgGradient:"linear(to-r, green.300, yellow.200)",children:[t?Object(m.jsx)(F,{}):null,Object(m.jsx)($,{}),t?Object(m.jsx)(K,{}):null]})},Z=new u.QueryClient,ee=function(){return Object(m.jsx)(a.a,{theme:c.theme,children:Object(m.jsx)(u.QueryClientProvider,{client:Z,children:Object(m.jsx)(y,{children:Object(m.jsx)(v,{children:Object(m.jsxs)(s.a,{h:"100vh",children:[Object(m.jsx)(T,{}),Object(m.jsx)(Y,{})]})})})})})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,143)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),r(e),i(e),o(e),a(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(m.jsx)(r.StrictMode,{children:Object(m.jsx)(ee,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),te()}},[[116,1,2]]]);
//# sourceMappingURL=main.0ccf78df.chunk.js.map